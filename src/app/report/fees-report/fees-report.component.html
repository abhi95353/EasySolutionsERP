<div class="row">
    <div class="col-12">
        <h3 style="text-transform: uppercase; letter-spacing: 0.9px;">Fee Report</h3>
    </div>
    <hr class="p-0 m-0">

    <br>

    <div class="col-12 tabs my-2" *ngIf="this.school_code != 'Select School' ;">
        <div class="row py-4" style="background-color: white;">
         <div class="col-12 col-lg-4">
             <div class="inputBox">
                 <select [(ngModel)]="session" (change)="showMonth()">
                     <option *ngFor="let dt of sessionList" value="{{dt | json}}">{{dt.session}}</option>
                 </select>
                 <label >Session</label>
             </div>
         </div>
 
         <div class="col-12 col-lg-4">
             <div class="inputBox" >
                 <select class="form-control" [(ngModel)]="monthId"  required  (change)="changeMonth()">
                     <option *ngFor="let data of monthList" value="{{data}}">{{data}}</option>
                 </select>
                 <label>Month</label>
             </div> 
         </div>
 
         <div class="col-12 col-lg-4">
             <div class="inputBox">
                <input type="date" [(ngModel)]="dateId" (click)="showDate()">
                 <label>Date</label>
             </div>
         </div>
 
         <div class="col-12 my-4">
             <span class="btn btn-sm btn-success" (click)="feesReport()">Apply Filter</span>
         </div>
        </div>
     </div>

     <div class="row">
        <div class="col-12">
            <app-fees-excel-report></app-fees-excel-report>
        </div>
     </div>

    <div class="col-12 my-2 py-4 " style="background-color: white;">
        <div class="row px-1">
            <div class="col-12 col-lg-6 my-2">
               
                <button class="btn btn-sm btn-warning" (click)="downloadCSV()">Export Excel</button>&nbsp;
                <button
                        class="btn btn-warning btn-sm"
                        [useExistingCss]="true"
                        printTitle="Fees Report" 
                        printSectionId="print-section"
                        ngxPrint>print
                    </button>
                

            </div>
            <div class="col-12 col-lg-6" style="text-align: right;">
               
                    <div style="display: flex;justify-content: end;">
                      <input type="search" class="form-control" placeholder="Search" [(ngModel)]="searchText">
                    
              
                </div>
                

            </div>
            
        </div> 
        <div class="table-responsive mx-1 my-4" style="border-radius: 5px;"  id="print-section">
            <table class="table table-striped table-hover table-bordered border-success table-responsive table-sm table-report" id="htmlData">
                <thead class="bg-success text-white">
                    <tr>
                        <th scope="col">#</th>
                        <th scope="col">Receipt&nbsp;No</th>
                        <th scope="col">Date</th>
                        <th scope="col">Account</th>
                        <th scope="col">Name</th>
                        <th scope="col">Class/Section</th>
                        <th scope="col" style="white-space: nowrap;">Monthly Fee</th>
                        <th scope="col">Conveyance</th>
                        <th scope="col">Admission</th>
                        <th scope="col">Registration</th>
                        <th scope="col">Misc.</th>
                        <th scope="col">Pay&nbsp;Type</th>
                        <th scope="col">Amount</th>
                    </tr>
                </thead> 
                <tbody>

                    <ng-container *ngIf="this.reportList == null; else nodatafound">
                        <tr>
                                
                            <td [attr.colspan]="13" style="text-align: center;font-size: 20px;color: red;">No Data Found </td>
                        </tr>
                    </ng-container>

                    <ng-template #nodatafound>
                        <ng-container *ngIf="loadingStatus; else loading">
                            <tr>
                                <td [attr.colspan]="13" style="text-align: center; font-size: 24px; color: red;"><i class="fa fa-spinner fa-pulse"></i></td>
                            </tr>
                        </ng-container>
                        <ng-template #loading>
                            
                            <ng-container *ngFor="let data of reportList">
                                <ng-container *ngFor="let dt of data.data.detail  | filter:searchText;let i = index;let l = last">
                                    <tr>
                                        <td>{{i+1}}</td>
                                        <td>{{dt.receipt_no}}</td>
                                        <td style="white-space: nowrap;">{{dt.date}}</td>
                                        <td>{{dt.student.account}}</td>
                                        <td style="white-space: nowrap;">{{dt.student.name}}</td>
                                        <td style="white-space: nowrap;">{{dt.student.standard.notation}}/{{dt.student.division.notation}}</td>
                                        <td style="text-align: right;">{{dt.tut_paid}}</td>
                                        <td style="text-align: right;">{{dt.conv_paid}}</td>
                                        <td style="text-align: right;">{{dt.adm_paid}}</td>
                                        <td style="text-align: right;">{{dt.reg_paid}}</td>
                                        <td style="text-align: right;">{{dt.lmf_paid}}</td>
                                        <td style="text-align: right;"><b>{{dt.pay_type.pay}}</b></td>
                                        <td style="text-align: right;">{{dt.tot_paid}}</td>
                                        
                                    </tr>
                                    <tr *ngIf="l">
                                        
                                        <td [attr.colspan]="12" style="text-align: right;font-size: 20px;">Total Amount : </td>
                                        <td style="text-align: right; font-size: 20px;" ><b>{{data.data.amount}}</b></td>
                                    </tr>
                                </ng-container>
                            </ng-container>
                        </ng-template>
                    </ng-template>

                    
                    
                    
                </tbody>
            </table>
         
        </div>
    </div>
</div>

<!-- <button ngxClipboard [cbContent]="copy(ok)" (cbOnSuccess)="copied($event)">Copy</button> -->
